{% extends "base.html" %}
{% block title %}Payment Details - QGig{% endblock %}
{% block content %}
<div class="container">
    <div style="display: flex; align-items: center; justify-content: space-between; gap: 1rem; margin-bottom: 1.5rem;">
        <h1 style="font-size: 2rem; font-weight: 700; margin: 0;">
            <i class="fas fa-receipt"></i> Payment Details
        </h1>
        <a href="{{ url_for('web.payments_history') }}" class="btn btn-outline">
            <i class="fas fa-arrow-left"></i> Back
        </a>
    </div>

    <div class="card" style="max-width: 900px;">
        <div class="card-header" style="display:flex; align-items:center; justify-content: space-between; gap: 1rem;">
            <div>
                <div style="font-size: 0.875rem; color: var(--gray-500);">Reference</div>
                <div style="font-weight: 700; font-size: 1.125rem;">{{ payment.pesapal_merchant_reference }}</div>
            </div>
            {% set status_value = payment.status.value if payment.status is not none and payment.status.value is defined else payment.status %}
            <span class="badge-status badge-{{ status_value }}">{{ status_value|upper }}</span>
        </div>

        <div class="card-body">
            <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 1rem;">
                <div>
                    <div style="font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.06em; color: var(--gray-500); font-weight: 700;">Gig</div>
                    <div style="font-weight: 700; margin-top: 0.25rem;">
                        <a href="{{ url_for('web.gig_detail', gig_id=payment.gig_id) }}" style="color: var(--primary-color); text-decoration: none;">
                            {{ payment.gig.title }}
                        </a>
                    </div>
                </div>

                <div>
                    <div style="font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.06em; color: var(--gray-500); font-weight: 700;">Amount</div>
                    <div style="font-weight: 800; margin-top: 0.25rem;">UGX {{ "{:,.0f}".format(payment.amount) }}</div>
                </div>

                <div>
                    <div style="font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.06em; color: var(--gray-500); font-weight: 700;">Date</div>
                    <div style="margin-top: 0.25rem;">{{ payment.created_at.strftime('%b %d, %Y %H:%M') }}</div>
                </div>

                <div>
                    <div style="font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.06em; color: var(--gray-500); font-weight: 700;">Institution</div>
                    <div style="margin-top: 0.25rem;">{{ payment.institution.name }}</div>
                </div>

                <div>
                    <div style="font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.06em; color: var(--gray-500); font-weight: 700;">Professional</div>
                    <div style="margin-top: 0.25rem;">
                        {{ payment.professional.full_name or payment.professional.user.email }}
                    </div>
                </div>

                <div>
                    <div style="font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.06em; color: var(--gray-500); font-weight: 700;">Tracking ID</div>
                    <div style="margin-top: 0.25rem;">{{ payment.pesapal_order_tracking_id or '-' }}</div>
                </div>
            </div>

            {% if payment.pesapal_transaction_id %}
            <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--gray-200);">
                <div style="font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.06em; color: var(--gray-500); font-weight: 700;">Transaction ID</div>
                <div style="margin-top: 0.25rem;">{{ payment.pesapal_transaction_id }}</div>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
